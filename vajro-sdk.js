!function(o,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.VajroSDK=n():o.VajroSDK=n()}(window,(()=>(()=>{"use strict";var o={d:(n,e)=>{for(var t in e)o.o(e,t)&&!o.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(o,n)=>Object.prototype.hasOwnProperty.call(o,n),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},n={};o.r(n),o.d(n,{actions:()=>e,initialize:()=>a,isSDKReady:()=>l,subscribe:()=>I,triggers:()=>t,unsubscribe:()=>b,variables:()=>r});var e={};o.r(e),o.d(e,{addToCart:()=>P,openAuthentication:()=>O,openCart:()=>g,openCollection:()=>f,openCustomBlock:()=>y,openInAppBrowser:()=>w,openLandingPage:()=>h,openProduct:()=>p,openUrl:()=>v});var t={};o.r(t),o.d(t,{customerUpdated:()=>_,onCartUpdated:()=>C,onPageLoaded:()=>A});const r={},i=o=>{console.log("🔄 Updating appContext with:",o),Object.keys(o).forEach((n=>{"object"!=typeof o[n]||null===o[n]||Array.isArray(o[n])?r[n]=o[n]:r[n]=Object.assign(Object.assign({},r[n]),o[n])})),console.log("✅ Updated VajroSDK.variables:",r)};let c=!1;const a=(o={})=>{console.log("🚀 Initializing VajroSDK with Context:",o),o&&0!==Object.keys(o).length?i(o):console.warn("⚠️ No app context provided. Waiting for WebView updates..."),c=!0,console.log("✅ VajroSDK is initialized:",JSON.stringify(r,null,2))},l=()=>c;var s;!function(o){o.OPEN_PRODUCT="openProduct",o.OPEN_COLLECTION="openCollection",o.OPEN_CART="openCart",o.OPEN_CUSTOM_BLOCK="openCustomBlock",o.ADD_TO_CART="addToCart",o.OPEN_LANDING_PAGE="openLandingPage",o.OPEN_URL="openUrl",o.OPEN_IN_APP_BROWSER="openInAppBrowser",o.OPEN_AUTHENTICATION="openAuthentication"}(s||(s={}));const d=(o,n)=>(console.log(`Dispatching action: ${o}`,n),new Promise(((e,t)=>{window.flutter_inappwebview&&"function"==typeof window.flutter_inappwebview.callHandler?window.flutter_inappwebview.callHandler(o,n).then((()=>{console.log(`Action dispatched successfully: ${o}`),e()})).catch((n=>{console.error(`Failed to dispatch action: ${o}`,n),t(n)})):(console.error("Flutter engine is not available."),t(new Error("Flutter engine is not available.")))})));const p=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("📂 Validating OpenProduct Payload..."),(o=>{if(!o.productId&&!o.productHandle)throw new Error("Either productId or productHandle must be provided.");if(o.productId&&"string"!=typeof o.productId)throw new Error("Invalid productId. It must be a non-empty string.");if(o.productHandle&&"string"!=typeof o.productHandle)throw new Error("Invalid productHandle. It must be a non-empty string.");if(o.variantId&&"string"!=typeof o.variantId)throw new Error("Invalid variantId. It must be a string.");if(o.variantHandle&&"string"!=typeof o.variantHandle)throw new Error("Invalid variantHandle. It must be a string.");if(void 0===o.openInNewPage)o.openInNewPage=!0;else if("boolean"!=typeof o.openInNewPage)throw new Error("Invalid openInNewPage. It must be a boolean.")})(o),console.log("📂 Dispatching OpenProduct Action..."),yield d(s.OPEN_PRODUCT,o),console.log("✅ Product Opened Successfully!")}catch(o){return console.error("❌ Failed to open product:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r},u=o=>{if(!o.collectionHandle&&!o.collectionId)throw new Error('Either "collectionHandle" or "collectionId" must be provided.');if(o.collectionHandle&&"string"!=typeof o.collectionHandle)throw new Error('"collectionHandle" must be a string.');if(o.collectionId&&"string"!=typeof o.collectionId)throw new Error('"collectionId" must be a string.')};const f=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("📂 Validating OpenCollection Payload..."),u(o),console.log("📂 Dispatching OpenCollection Action..."),yield d(s.OPEN_COLLECTION,o),console.log("✅ Collection Opened Successfully!")}catch(o){return console.error("❌ Failed to open collection:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r};const g=()=>{return o=void 0,n=void 0,t=function*(){try{console.log("🛒 Dispatching OpenCart Action..."),yield d(s.OPEN_CART,null),console.log("✅ Cart Opened Successfully!")}catch(o){return console.error("❌ Failed to open cart:",o),Promise.reject(o)}},new((e=void 0)||(e=Promise))((function(r,i){function c(o){try{l(t.next(o))}catch(o){i(o)}}function a(o){try{l(t.throw(o))}catch(o){i(o)}}function l(o){var n;o.done?r(o.value):(n=o.value,n instanceof e?n:new e((function(o){o(n)}))).then(c,a)}l((t=t.apply(o,n||[])).next())}));var o,n,e,t};const y=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("🛠️ Validating OpenCustomBlock Payload..."),(o=>{if(!o.id||"string"!=typeof o.id||""===o.id.trim())throw new Error('Invalid "id". It must be a non-empty string.')})(o),console.log("🛠️ Dispatching OpenCustomBlock Action..."),yield d(s.OPEN_CUSTOM_BLOCK,o),console.log("✅ Custom Block Opened Successfully!")}catch(o){return console.error("❌ Failed to open custom block:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r};const h=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("🛠️ Validating OpenLandingPage Payload..."),(o=>{if(!o.path||"string"!=typeof o.path||""===o.path.trim())throw new Error('Invalid "path". It must be a non-empty string.')})(o),console.log("🛠️ Dispatching OpenLandingPage Action..."),yield d(s.OPEN_CUSTOM_BLOCK,o),console.log("✅ Landing Page Opened Successfully!")}catch(o){return console.error("❌ Failed to open landing page:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r};const v=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("🛠️ Validating OpenUrl Payload..."),(o=>{if(!o.path||"string"!=typeof o.path||""===o.path.trim())throw new Error('Invalid "path". It must be a non-empty string.')})(o),console.log("🛠️ Dispatching OpenUrl Action..."),yield d(s.OPEN_URL,o),console.log("✅ Url Opened Successfully!")}catch(o){return console.error("❌ Failed to open url:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r};const w=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("🛠️ Validating OpenInAppBrowser Payload..."),(o=>{if(!o.path||"string"!=typeof o.path||""===o.path.trim())throw new Error('Invalid "path". It must be a non-empty string.')})(o),console.log("🛠️ Dispatching OpenInAppBrowser Action..."),yield d(s.OPEN_IN_APP_BROWSER,o),console.log("✅ InAppBrowser Opened Successfully!")}catch(o){return console.error("❌ Failed to open InAppBrowser:",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r};const O=o=>{return n=void 0,e=void 0,r=function*(){try{console.log("🛠️ Validating OpenAuthentication Payload..."),(o=>{if(!o.type||"string"!=typeof o.type||""===o.type.trim())throw new Error('Invalid "type". It must be a non-empty string.')})(o),console.log("🛠️ Dispatching OpenAuthentication Action..."),yield d(s.OPEN_AUTHENTICATION,o),console.log("✅ Authentication Opened Successfully!")}catch(o){return console.error("❌ Failed to open Authentication",o),Promise.reject(o)}},new((t=void 0)||(t=Promise))((function(o,i){function c(o){try{l(r.next(o))}catch(o){i(o)}}function a(o){try{l(r.throw(o))}catch(o){i(o)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(o){o(e)}))).then(c,a)}l((r=r.apply(n,e||[])).next())}));var n,e,t,r},P=o=>new Promise(((n,e)=>{try{u(o),d(s.ADD_TO_CART,null),n()}catch(o){console.error("Failed to open cart:",o),e(o)}})),m={},I=(o,n)=>{m[o]||(m[o]=[]),m[o].push(n),console.log(`✅ Subscribed to event: ${o}`),console.log("🔍 Current Event Listeners:",m)},b=(o,n)=>{m[o]&&(m[o]=m[o].filter((o=>o!==n)),console.log(`❌ Unsubscribed from event: ${o}`))},E=(o,n)=>{console.log(`🚀 Dispatching event: ${o}`,n),i(n),m[o]?m[o].forEach((e=>{try{e(n)}catch(n){console.error(`❌ Error executing listener for ${o}:`,n)}})):console.log(`⚠️ No subscribers found for event: ${o}`)},A=o=>{console.log("🚀 ON_PAGE_LOADED Triggered:",o),E("onPageLoaded",o)},C=o=>{console.log("🚀 ON_CART_UPDATED Triggered:",o),E("onCartUpdated",o)},_=o=>{console.log("🚀 ON_CUSTOMER_UPDATED Triggered:",o),E("onCustomerUpdated",o)};return n})()));

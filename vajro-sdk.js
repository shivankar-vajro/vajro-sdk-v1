!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.VajroSDK=o():e.VajroSDK=o()}(window,(()=>(()=>{"use strict";var e={d:(o,t)=>{for(var n in t)e.o(t,n)&&!e.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:t[n]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{actions:()=>t,initialize:()=>c,isSDKReady:()=>a,subscribe:()=>v,triggers:()=>n,unsubscribe:()=>b,variables:()=>r});var t={};e.r(t),e.d(t,{addToCart:()=>w,openCart:()=>f,openCollection:()=>u,openCustomBlock:()=>g,openProduct:()=>p});var n={};e.r(n),e.d(n,{customerUpdated:()=>O,onCartUpdated:()=>I,onPageLoaded:()=>m});const r={},i=e=>{console.log("ðŸ”„ Updating appContext with:",e),Object.keys(e).forEach((o=>{"object"!=typeof e[o]||null===e[o]||Array.isArray(e[o])?r[o]=e[o]:r[o]=Object.assign(Object.assign({},r[o]),e[o])})),console.log("âœ… Updated VajroSDK.variables:",r)};let l=!1;const c=(e={})=>{console.log("ðŸš€ Initializing VajroSDK with Context:",e),e&&0!==Object.keys(e).length?i(e):console.warn("âš ï¸ No app context provided. Waiting for WebView updates..."),l=!0,console.log("âœ… VajroSDK is initialized:",JSON.stringify(r,null,2))},a=()=>l;var d;!function(e){e.OPEN_PRODUCT="openProduct",e.OPEN_COLLECTION="openCollection",e.OPEN_CART="openCart",e.OPEN_CUSTOM_BLOCK="openCustomBlock",e.ADD_TO_CART="addToCart"}(d||(d={}));const s=(e,o)=>(console.log(`Dispatching action: ${e}`,o),new Promise(((t,n)=>{window.flutter_inappwebview&&"function"==typeof window.flutter_inappwebview.callHandler?window.flutter_inappwebview.callHandler(e,o).then((()=>{console.log(`Action dispatched successfully: ${e}`),t()})).catch((o=>{console.error(`Failed to dispatch action: ${e}`,o),n(o)})):(console.error("Flutter engine is not available."),n(new Error("Flutter engine is not available.")))})));const p=e=>{return o=void 0,t=void 0,r=function*(){try{return(e=>{if(!e.productId&&!e.productHandle)throw new Error("Either productId or productHandle must be provided.");if(e.productId&&"string"!=typeof e.productId)throw new Error("Invalid productId. It must be a non-empty string.");if(e.productHandle&&"string"!=typeof e.productHandle)throw new Error("Invalid productHandle. It must be a non-empty string.");if(e.variantId&&"string"!=typeof e.variantId)throw new Error("Invalid variantId. It must be a string.");if(e.variantHandle&&"string"!=typeof e.variantHandle)throw new Error("Invalid variantHandle. It must be a string.");if(void 0===e.openInNewPage)e.openInNewPage=!0;else if("boolean"!=typeof e.openInNewPage)throw new Error("Invalid openInNewPage. It must be a boolean.")})(e),yield s(d.OPEN_PRODUCT,e)}catch(e){return console.error("ðŸš¨ OpenProduct Action Failed:",e),Promise.reject(e)}},new((n=void 0)||(n=Promise))((function(e,i){function l(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(o){var t;o.done?e(o.value):(t=o.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,c)}a((r=r.apply(o,t||[])).next())}));var o,t,n,r},u=e=>new Promise(((o,t)=>{try{(e=>{if(!e.collectionHandle&&!e.collectionId)throw new Error('Either "collectionHandle" or "collectionId" must be provided.');if(e.collectionHandle&&"string"!=typeof e.collectionHandle)throw new Error('"collectionHandle" must be a string.');if(e.collectionId&&"string"!=typeof e.collectionId)throw new Error('"collectionId" must be a string.')})(e),s(d.OPEN_COLLECTION,e),o()}catch(e){console.error("Failed to open collection:",e),t(e)}}));const f=()=>{return e=void 0,o=void 0,n=function*(){try{console.log("ðŸ›’ Dispatching OpenCart Action..."),yield s(d.OPEN_CART,null),console.log("âœ… Cart Opened Successfully!")}catch(e){return console.error("âŒ Failed to open cart:",e),Promise.reject(e)}},new((t=void 0)||(t=Promise))((function(r,i){function l(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(l,c)}a((n=n.apply(e,o||[])).next())}));var e,o,t,n},g=e=>new Promise(((o,t)=>{try{(e=>{if(!e.id||"string"!=typeof e.id||""===e.id.trim())throw new Error('Invalid "id". It must be a non-empty string.');if(!e.type||"string"!=typeof e.type||""===e.type.trim())throw new Error('Invalid "type". It must be a non-empty string.')})(e),s(d.OPEN_CUSTOM_BLOCK,e).then(o).catch(t)}catch(e){console.error("Validation failed:",e),t(e)}})),w=e=>new Promise(((o,t)=>{try{(e=>{if(!e.collectionHandle&&!e.collectionId)throw new Error('Either "collectionHandle" or "collectionId" must be provided.');if(e.collectionHandle&&"string"!=typeof e.collectionHandle)throw new Error('"collectionHandle" must be a string.');if(e.collectionId&&"string"!=typeof e.collectionId)throw new Error('"collectionId" must be a string.')})(e),s(d.ADD_TO_CART,null),o()}catch(e){console.error("Failed to open cart:",e),t(e)}})),y={},v=(e,o)=>{y[e]||(y[e]=[]),y[e].push(o),console.log(`âœ… Subscribed to event: ${e}`),console.log("ðŸ” Current Event Listeners:",y)},b=(e,o)=>{y[e]&&(y[e]=y[e].filter((e=>e!==o)),console.log(`âŒ Unsubscribed from event: ${e}`))},h=(e,o)=>{console.log(`ðŸš€ Dispatching event: ${e}`,o),i(o),y[e]?y[e].forEach((t=>{try{t(o)}catch(o){console.error(`âŒ Error executing listener for ${e}:`,o)}})):console.log(`âš ï¸ No subscribers found for event: ${e}`)},m=e=>{console.log("ðŸš€ ON_PAGE_LOADED Triggered:",e),h("onPageLoaded",e)},I=e=>{console.log("ðŸš€ ON_CART_UPDATED Triggered:",e),h("onCartUpdated",e)},O=e=>{console.log("ðŸš€ ON_CUSTOMER_UPDATED Triggered:",e),h("onCustomerUpdated",e)};return o})()));
